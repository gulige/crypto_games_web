var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function a(t){try{c(n.next(t))}catch(e){o(e)}}function s(t){try{c(n["throw"](t))}catch(e){o(e)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,s)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(a=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){c.label=i[1];break}if(6===i[0]&&c.label<a[1]){c.label=a[1],a=i;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(i);break}a[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(n){i=[6,n],o=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Player=function(t){function e(e,i){var n=t.call(this)||this;return n.task={action:"idle",target:null,status:null},n.position=new egret.Point(0,0),n.items=[],n.createPlayer(e,i),n}return __extends(e,t),e.prototype.createPlayer=function(t,e){this.playerBitmap=this.createBitmapByName(t),this.playerBitmap.width=50,this.playerBitmap.height=80,this.playerBitmap.x=this.position.x,this.playerBitmap.y=this.position.y,this.playerBitmap.touchEnabled=!0,this.addChild(this.playerBitmap),this.touchEnabled=!0,this.uuid=(new Date).getTime(),this.setName(e.acc_name),this.setCellId(e.cell_id),this.setArmor(e.armor),this.setAttack(e.attack),this.setLife(e.hp),this.setDefense(e.defense),this.setItems(e.items),this.setWeapon(e.weapon),this.setGold(e.win_eos)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.getBitmap=function(){return this.playerBitmap},e.prototype.setTask=function(t){this.task=t},e.prototype.getTask=function(){return this.task},e.prototype.getHouse=function(){return this.house},e.prototype.getPosition=function(){var t={x:this.x,y:this.y};return t},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.getName=function(){return this.accName},e.prototype.setName=function(t){this.accName=t},e.prototype.getLife=function(){return this.hp},e.prototype.setLife=function(t){this.hp=t},e.prototype.destroy=function(){this.playerBitmap=null},e.prototype.getUUID=function(){return this.uuid},e.prototype.getGold=function(){return this.gold},e.prototype.setGold=function(t){this.gold=t},e.prototype.getCellId=function(){return this.cell_id},e.prototype.setCellId=function(t){this.cell_id=t},e.prototype.getArmor=function(){return this.armor},e.prototype.setArmor=function(t){this.armor=t},e.prototype.getAttack=function(){return this.attack},e.prototype.setAttack=function(t){this.attack=t},e.prototype.getDefense=function(){return this.defense},e.prototype.setDefense=function(t){this.defense=t},e.prototype.getWeapon=function(){return this.weapon},e.prototype.setWeapon=function(t){this.weapon=t},e.prototype.getItems=function(){return this.items},e.prototype.setItems=function(t){this.items=t},e}(egret.DisplayObjectContainer);__reflect(Player.prototype,"Player");var Board=function(t){function e(e,i){var n=t.call(this)||this;return n.life={full:100,remain:100},n.gold=100,n.playerContainer=new egret.DisplayObjectContainer,n.colorMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n.createBoard(e,i),n}return __extends(e,t),e.prototype.createBoard=function(t,e){this.cellList=[];for(var i=0;t>i;i++)for(var n=0;e>n;n++){var r=this.createCell(i,n,this.cellList.length);this.addChild(r)}this.addChild(this.playerContainer)},e.prototype.createCell=function(t,e,i){var n=new Cell(t,e,i);return this.cellList.push(n),n},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.getCellList=function(){return this.cellList},e.prototype.getCellById=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.cellList.filter(function(e){return e.getID()==t})];case 1:return e=i.sent(),[2,e[0]]}})})},e.prototype.getCellByXY=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return[4,this.cellList.filter(function(i){var n=i.getXY();return n.x==t&&n.y==e})];case 1:return i=n.sent(),[2,i[0]]}})})},e.prototype.putPlayer=function(t){this.playerContainer.addChild(t)},e.prototype.clearPlayers=function(){this.playerContainer.removeChildren()},e.prototype.removePlayer=function(t){this.playerContainer.removeChild(t)},e}(egret.DisplayObjectContainer);__reflect(Board.prototype,"Board");var House=function(t){function e(e,i){var n=t.call(this)||this;return n.life={full:100,remain:100},n.gold=100,n.colorMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n.game=i,n.createHouse(e),n}return __extends(e,t),e.prototype.createHouse=function(t){this.name=t.name,this.houseBitmap=this.createBitmapByName(t.bitmap),this.houseBitmap.width=80,this.houseBitmap.height=80,this.houseBitmap.touchEnabled=!0,this.addChild(this.houseBitmap),this.touchEnabled=!0,this.id=this.game.game_id,this.joinEos=this.game.join_eos,this.game_progress-this.game.game_progress,this.playerList=[],this.createPlayer(this.game.players),this.clock=new Clock},e.prototype.createPlayer=function(t){var e=this;t.map(function(t,i){var n=e.playerList.length%2==0?"cow_boy_png":"cow_girl_png",r=new Player(n,t);e.playerList.push(r)})},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.getPlayerByName=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.playerList.filter(function(e){return e.getName()==t})];case 1:return e=i.sent(),e.length>0?[2,e[0]]:[2,null]}})})},e.prototype.getPlayerListByCellId=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e=this.playerList.filter(function(e){return e.getCellId()==t}),[2]})})},e.prototype.getBitmap=function(){return this.houseBitmap},e.prototype.getPlayerList=function(){return this.playerList},e.prototype.getPosition=function(){var t={x:this.x,y:this.y};return t},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.getLife=function(){return this.life},e.prototype.setLife=function(t){this.life=t},e.prototype.destroy=function(){this.houseBitmap=null,this.playerList=[],this.game=null,this.clock=null},e.prototype.getID=function(){return this.id},e.prototype.setID=function(t){return this.id=t},e.prototype.getJoinEos=function(){return this.joinEos},e.prototype.getGold=function(){return this.gold},e.prototype.setGold=function(t){this.gold=t},e.prototype.getHouseName=function(){return this.name},e.prototype.clearPlayerList=function(){this.playerList=[]},e.prototype.getClock=function(){return this.clock},e.prototype.getBoard=function(){return this.game.board},e.prototype.getProgress=function(){return this.game.game_progress},e.prototype.getStep=function(){return this.game.step},e}(egret.DisplayObjectContainer);__reflect(House.prototype,"House");var Item=function(t){function e(e){var i=t.call(this)||this;return i.createItem(e),i}return __extends(e,t),e.prototype.createItem=function(t){this.itemBitMap=this.createBitmapByName(t),this.itemBitMap.width=70,this.itemBitMap.height=70,this.itemBitMap.touchEnabled=!0,this.addChild(this.itemBitMap),this.touchEnabled=!0},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.getBitmap=function(){return this.itemBitMap},e.prototype.getPosition=function(){var t={x:this.x,y:this.y};return t},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.destroy=function(){this.itemBitMap=null},e}(egret.DisplayObjectContainer);__reflect(Item.prototype,"Item");var ItemUtils=function(t){function e(e,i,n){return t.call(this)||this}return __extends(e,t),e.createBitmapById=function(t){var e=new egret.Bitmap,i=RES.getRes(this.items["id_"+t].png);return e.texture=i,e.width=70,e.height=70,e},e.createItemById=function(t){var e=new Item(this.items["id_"+t].png);return e.setId(t),e},e.getItemNameById=function(t){var e=this.items["id_"+t].name;return e},e.items={id_0:{name:"",png:"empty_png"},id_1:{name:"炸弹",png:"bomb_png"},id_2:{name:"",png:"empty_png"},id_3:{name:"手枪",png:"handgun_png"},id_4:{name:"步枪",png:"rifle_png"},id_5:{name:"超级步枪",png:"supergun_png"},id_6:{name:"一级防具",png:"shield_L1_png"},id_7:{name:"二级防具",png:"shield_L2_png"},id_8:{name:"三级防具",png:"shield_L3_png"},id_9:{name:"决斗卡",png:"battle_png"},id_10:{name:"复活卡",png:"life_png"},id_11:{name:"药箱",png:"aid_png"},id_12:{name:"急救箱",png:"first_aid_png"},id_13:{name:"",png:"empty_png"},id_14:{name:"黄金矿点",png:"gold_mine_png"}},e}(egret.HashObject);__reflect(ItemUtils.prototype,"ItemUtils");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e._touchStatus=!1,e._distance=new egret.Point,e.textfield=new egret.TextField,e.tmxTileMap=tiled.TMXTilemap,e._route=new egret.Shape,e._life=new egret.Shape,e.soilderIconList=[],e.houseList=[],e.board=null,e.backgroundMusic=new egret.Sound,e.playerInfo=new egret.Shape,e.player_name=new egret.TextField,e.player_hp=new egret.TextField,e.player_attack=new egret.TextField,e.player_defense=new egret.TextField,e.player_eos=new egret.TextField,e.player_item=new egret.TextField,e.player_weapon=new egret.TextField,e.townRandomName=["johny","kitty","peter"],e.num=0,e.canvas=document.getElementsByTagName("CANVAS")[0],e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),t=this,e="resource/desert.tmx",i=new egret.URLLoader,i.dataFormat=egret.URLLoaderDataFormat.TEXT,i.addEventListener(egret.Event.COMPLETE,function(i){var n=egret.XML.parse(i.target.data);this.tmxTileMap=new tiled.TMXTilemap(2e3,2e3,n,e),this.tmxTileMap.render(),t.addChild(this.tmxTileMap),t.createGameScene()},e),i.load(new egret.URLRequest(e)),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,r,o,a,s,c=this;return __generator(this,function(h){return t=this.createBitmapByName("city_png"),this.stage.addChild(t),t.width=80,t.height=100,t.x=10,t.y=5,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createGame.bind(this,{name:"johny",bitmap:"house_png"}),this),e=this.createBitmapByName("bg1_jpg"),this.stage.addChild(e),e.x=10,e.y=115,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setMap,this),i=this.createBitmapByName("cow_boy_png"),this.stage.addChild(i),i.x=10,i.y=200,i.width=50,i.height=80,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.joinGame,this),n=this.createBitmapByName("recall_png"),this.stage.addChild(n),n.x=10,n.y=300,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.kickOff,this),this.animation({json:"pao_json",png:"pao_png",data:"pao",x:0,y:800}).then(function(t){c.stage.addChild(t),t.play(-1)}),this.animation({json:"frog_json",png:"frog_png",data:"frog",x:1130,y:830}).then(function(t){c.stage.addChild(t),t.play(-1)}),this.login=this.createBitmapByName("login_png"),this.login.x=1150,this.login.y=10,this.login.touchEnabled=!0,this.login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginGame,this),this.logout=this.createBitmapByName("logout_png"),this.logout.x=1150,this.logout.y=10,this.logout.touchEnabled=!0,this.logout.addEventListener(egret.TouchEvent.TOUCH_TAP,this.logoutGame,this),ScatterUtils.getIdentity().then(function(t){null==t?c.stage.addChild(c.login):(ScatterUtils.login(),c.stage.addChild(c.logout))}),r=this.createBitmapByName("play_png"),this.stage.addChild(r),r.x=1150,r.y=300,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backgroundSound.bind(this,RES.getRes("glory_1_mp3").url),this),o=this.createBitmapByName("play_png"),this.stage.addChild(o),o.x=1150,o.y=350,o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backgroundSound.bind(this,RES.getRes("honor_1_mp3").url),this),a=this.createBitmapByName("play_png"),this.stage.addChild(a),a.x=1150,a.y=400,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backgroundSound.bind(this,RES.getRes("easy_1_mp3").url),this),s=this.createBitmapByName("stop_png"),this.stage.addChild(s),s.x=1150,s.y=450,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){c.backgroundMusicChannel&&c.backgroundMusicChannel.stop()},this),this.stage.addChild(this.textfield),this.refreshHouseList(),egret.setInterval(function(){c.refreshHouseList().then(function(){c.selectedHouse&&c.houseList.map(function(t){return __awaiter(c,void 0,void 0,function(){var e=this;return __generator(this,function(i){switch(i.label){case 0:return t.getID()!=this.selectedHouse.getID()?[3,2]:(this.selectedHouse=t,[4,this.updateObjectsInBoard(t)]);case 1:i.sent(),this.checkBattersInHouse(t),this.animation({json:"firework_json",png:"firework_png",data:"firework",x:500*Math.random(),y:500*Math.random()}).then(function(t){e.board.addChild(t),t.play(1),setTimeout(function(){e.board.removeChild(t)},4e3)}),i.label=2;case 2:return[2]}})})})})},this,5e3),[2]})})},e.prototype.initBoard=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(i){return null==this.board&&(this.board=new Board(11,11),this.board.x=200,this.board.y=110,this.stage.addChild(this.board),t=this.board.getCellList(),t.map(function(t){var i=t.getXY();t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.move(i.x,i.y,t.getPosition())},e)})),[2]})})},e.prototype.updateObjectsInBoard=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n=this;return __generator(this,function(r){return this.board.clearPlayers(),e=t.getBoard(),i=this.board.getCellList(),i.map(function(i,r){return __awaiter(n,void 0,void 0,function(){var n,o,a,s,c=this;return __generator(this,function(h){switch(h.label){case 0:return n=e[r],o=n.players,a=n.item,[4,ItemUtils.createItemById(a)];case 1:return s=h.sent(),i.addItem(s),o.map(function(e){t.getPlayerByName(e).then(function(t){t&&(t.setPosition(new egret.Point(i.x,i.y)),t.addEventListener(egret.TouchEvent.TOUCH_TAP,c.selectPlayer.bind(c,t),c),c.board.putPlayer(t))})}),[2]}})})}),[2]})})},e.prototype.refreshHouseList=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return[4,ScatterUtils.getAllGamesInfo().then(function(e){return __awaiter(t,void 0,void 0,function(){var t=this;return __generator(this,function(i){switch(i.label){case 0:return[4,this.houseList.map(function(e){t.stage.contains(e)&&(t.stage.removeChild(e),e.destroy(),e=null)})];case 1:return i.sent(),this.houseList=[],console.log(e),e.rows?[4,e.rows.map(function(e,i){t.createHouse({name:"johny",bitmap:"house_png"},e).then(function(e){e.setPosition(new egret.Point(100*(1+i),5)),t.stage.addChild(e),t.houseList.push(e)})})]:[3,3];case 2:return i.sent(),[3,4];case 3:alert("无游戏信息"),i.label=4;case 4:return[2]}})})})["catch"](function(t){console.error(t),alert("获取游戏信息失败")})];case 1:return e.sent(),[2]}})})},e.prototype.createGame=function(){var t=this;ScatterUtils.getIdentity().then(function(e){return null==e?void alert(ScatterUtils.message.authority):void ScatterUtils.createGame("1.0000 EOS").then(function(e){console.log("create",e),e.processed?t.refreshHouseList():(e=JSON.parse(e),alert("创建游戏失败:"+e.error.details[0].message))})["catch"](function(t){console.log(t),alert("取消创建游戏")})})},e.prototype.joinGame=function(){var t=this;ScatterUtils.getIdentity().then(function(e){return null==e?void alert(ScatterUtils.message.authority):t.selectedHouse?void ScatterUtils.joinGame(t.selectedHouse.getID(),t.selectedHouse.getJoinEos(),4,4).then(function(t){console.log("transaction",t),t.processed?alert("加入游戏！"):(t=JSON.parse(t),alert("加入游戏失败:"+t.error.details[0].message))})["catch"](function(t){console.error(t),alert("加入游戏失败:"+t)}):(console.log("no house selected"),void alert("请选择加入的游戏房间"))})},e.prototype.setMap=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return ScatterUtils.getIdentity().then(function(e){return null==e?void alert(ScatterUtils.message.authority):t.selectedHouse?void ScatterUtils.setMap(t.selectedHouse.getID()).then(function(t){console.log("result",t),1==t.succ?alert("棋盘地图设定成功！"):alert("棋盘地图已经设定")}):(console.log("no house selected"),void alert("请选择设定棋盘的游戏房间"))}),[2]})})},e.prototype.move=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return ScatterUtils.getIdentity().then(function(r){if(null==r)return void alert(ScatterUtils.message.authority);var o=n.selectedHouse.getID();ScatterUtils.move(o,t,e).then(function(r){return __awaiter(n,void 0,void 0,function(){var n,o;return __generator(this,function(a){switch(a.label){case 0:return console.log("move transaction",r),r.processed?[3,1]:(r=JSON.parse(r),alert("移动失败："+r.error.details[0].message),[3,4]);case 1:return[4,ScatterUtils.getCurrentAccountName()];case 2:return n=a.sent(),[4,this.selectedHouse.getPlayerList().filter(function(t){return t.getName()==n})];case 3:o=a.sent(),console.log("currentPlayer",o),o.length>0&&egret.Tween.get(o[0]).to(i,500,egret.Ease.sineIn).wait(0).call(this.checkCellItem.bind(this,t,e)),a.label=4;case 4:return[2]}})})})["catch"](function(t){console.error(t),alert("移动失败")})}),[2]})})},e.prototype.checkBattersInHouse=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,r=this;return __generator(this,function(o){return e=t.getBoard(),i=t.getProgress(),n=t.getStep(),e.map(function(t,e){return __awaiter(r,void 0,void 0,function(){var e,r=this;return __generator(this,function(o){switch(o.label){case 0:return t.players.length>0?[4,t.event_list.filter(function(t){return t.progress==i&&t.step==n&&"attack"==t.evt})]:[3,2];case 1:e=o.sent(),e.length>0&&this.board.getCellById(t.cell_id).then(function(t){return __awaiter(r,void 0,void 0,function(){var e,i;return __generator(this,function(n){return e=t.getBattleTime(),i=(new Date).getTime(),i-e>3e4&&(t.setBattleTime(i),this.attackTarget(t.getPosition())),[2]})})}),o.label=2;case 2:return[2]}})})}),[2]})})},e.prototype.checkCellItem=function(t,e){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(n){return this.board.getCellByXY(t,e).then(function(t){return __awaiter(i,void 0,void 0,function(){var e,i,n=this;return __generator(this,function(r){return e=t.getItem(),1==e.getId()?this.animation({json:"blow_json",png:"blow_png",data:"blow",x:t.x-100,y:t.y-100}).then(function(i){n.board.addChild(i),i.play(1),t.removeChild(e),n.actionSound(RES.getRes("blow_mp3").url),setTimeout(function(){n.board.removeChild(i)},1500)}):(i={x:0,y:-30},egret.Tween.get(e).to(i,300,egret.Ease.sineIn)),[2]})})}),[2]})})},e.prototype.kickOff=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return ScatterUtils.getIdentity().then(function(e){if(null==e)return void alert(ScatterUtils.message.authority);if(!t.selectedHouse)return console.log("no house selected"),void alert("请选择Kick Off的游戏房间");var i=t.selectedHouse.getID();ScatterUtils.kickOff(i).then(function(e){if(console.log(e),e.processed){var i=t.selectedHouse.getClock();i.start()}else e=JSON.parse(e),alert("KickOff游戏失败："+e.error.details[0].message)})}),[2]})})},e.prototype.createHouse=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n=this;return __generator(this,function(r){return i=new House(t,e),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.selectedHouse==i,n.selectedHouse=i,console.log("this.selectedHouse",n.selectedHouse),n.showLife(n.stage,i),n.showText(e.game_id+"号房:"+(2==e.game_progress?"已开局":"未开局"),{x:i.x,y:i.y+80}),n.initBoard().then(function(){n.updateObjectsInBoard(i).then(function(){n.updateClockInStage(i.getClock())})})},this),[2,i]})})},e.prototype.updateClockInStage=function(t){this.stage.contains(this.clock)&&this.stage.removeChild(this.clock),this.clock=t,this.clock.x=1150,this.clock.y=150,this.clock.start(),this.stage.addChild(this.clock)},e.prototype.createPlayer=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,r,o,a;return __generator(this,function(s){switch(s.label){case 0:return this.selectedHouse?(e=t.cell_id,i=this.selectedHouse.createPlayer(t),[4,this.board.getCellList().filter(function(t){return t.getID()==e})]):(console.log("no town selected"),[2]);case 1:return n=s.sent(),r=n[0].getPosition(),o=r.x,a=r.y,[2]}})})},e.prototype.loginGame=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return ScatterUtils.login().then(function(e){ScatterUtils.getAccountInfo(),e.login?(alert("欢迎: "+e.details),t.stage.contains(t.login)&&t.stage.removeChild(t.login),t.stage.contains(t.logout)||t.stage.addChild(t.logout)):alert(e.details)})["catch"](function(t){console.log("e",t),alert(t)}),[2]})})},e.prototype.logoutGame=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return ScatterUtils.logout().then(function(e){alert(e.details),e.logout&&(t.stage.contains(t.logout)&&t.stage.removeChild(t.logout),t.stage.contains(t.login)||t.stage.addChild(t.login))})["catch"](function(t){console.log("e",t),alert(t)}),[2]})})},e.prototype.animation=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(n){return e=new egret.MovieClipDataFactory(RES.getRes(t.json),RES.getRes(t.png)),i=new egret.MovieClip(e.generateMovieClipData(t.data)),i.x=t.x,i.y=t.y,[2,i]})})},e.prototype.showInfo=function(t){var e=this;this.board.contains(this.playerInfo)&&this.board.removeChild(this.playerInfo),this.playerInfo.graphics.clear(),this.playerInfo.graphics.beginFill(15658734),this.playerInfo.graphics.drawRoundRect(0,0,120,160,15,15),this.playerInfo.graphics.endFill(),this.playerInfo.x=t.x+50,this.playerInfo.y=t.y,this.board.addChild(this.playerInfo),this.player_name.x=this.playerInfo.x,this.player_name.y=this.playerInfo.y,this.player_name.size=18,this.player_name.textColor=0,this.player_name.text="玩家:"+t.getName(),this.board.addChild(this.player_name),this.player_hp.x=this.playerInfo.x,this.player_hp.y=this.playerInfo.y+20,this.player_hp.size=18,this.player_hp.textColor=0,this.player_hp.text="HP: "+t.getLife(),this.board.addChild(this.player_hp),this.player_weapon.x=this.playerInfo.x,this.player_weapon.y=this.playerInfo.y+40,this.player_weapon.size=18,this.player_weapon.textColor=0,this.player_weapon.text="武器: "+ItemUtils.getItemNameById(t.getWeapon()),this.board.addChild(this.player_weapon),this.player_attack.x=this.playerInfo.x,this.player_attack.y=this.playerInfo.y+60,this.player_attack.size=18,this.player_attack.textColor=0,this.player_attack.text="攻击力: "+t.getAttack(),this.board.addChild(this.player_attack),this.player_defense.x=this.playerInfo.x,this.player_defense.y=this.playerInfo.y+80,this.player_defense.size=18,this.player_defense.textColor=0,this.player_defense.text="防御力: "+t.getDefense(),this.board.addChild(this.player_defense),this.player_eos.x=this.playerInfo.x,this.player_eos.y=this.playerInfo.y+100,this.player_eos.size=18,this.player_eos.textColor=0,this.player_eos.text="EOS: "+t.getGold(),this.board.addChild(this.player_eos);var i=function(){var e="";return t.getItems().map(function(t){e=e+ItemUtils.getItemNameById(t)+"\n         "}),e};this.player_item.x=this.playerInfo.x,this.player_item.y=this.playerInfo.y+120,this.player_item.size=18,this.player_item.textColor=0,this.player_item.text="物品: "+i(),this.board.addChild(this.player_item),setTimeout(function(){e.board.removeChild(e.playerInfo),e.board.removeChild(e.player_name),e.board.removeChild(e.player_hp),e.board.removeChild(e.player_weapon),e.board.removeChild(e.player_attack),e.board.removeChild(e.player_defense),e.board.removeChild(e.player_eos),e.board.removeChild(e.player_item)},8e3)},e.prototype.recall=function(t){if(t||(t=this.selectedPlayer),t){this.unmountMovement(),this.clearRoute(t.getTask().action);var e=t.getTask().status,i=t.getHouse(),n=i.getPosition(),r=t.getBitmap();egret.Tween.removeTweens(r),e&&"completed"==e?egret.Tween.get(r).to(n,1e3,egret.Ease.sineIn):egret.Tween.get(r).to(n,0,egret.Ease.sineIn),t.setTask({action:"idle",target:null,status:null})}},e.prototype.initTask=function(t){var e=this;this.selectedPlayer?(this.unmountMovement(),this.selectedPlayer.setTask({action:t,target:null,status:null}),setTimeout(function(){e.mountMovement()},300)):console.log("no warrior selected")},e.prototype.showLife=function(t,e){var i,n=e.getLife();i=n.remain>=.6*n.full?60928:n.remain>=.4*n.full&&n.remain<.6*n.full?16776960:16711680,this._life.graphics.clear(),this._life.graphics.lineStyle(4,i),this._life.graphics.moveTo(e.getPosition().x,e.getPosition().y),this._life.graphics.lineTo(e.getPosition().x+n.remain,e.getPosition().y),t.addChild(this._life)},e.prototype.showText=function(t,e){this.textfield.x=e.x,this.textfield.y=e.y,this.textfield.size=22,this.textfield.textColor=0,this.textfield.text=t},e.prototype.selectPlayer=function(t){this.showInfo(t),this.actionSound(RES.getRes("yes_mp3").url)},e.prototype.actionSound=function(t){var e=new egret.Sound;e.addEventListener(egret.Event.COMPLETE,function(t){e.play(0,1)},this),e.load(t)},e.prototype.backgroundSound=function(t){this.backgroundMusicChannel&&this.backgroundMusicChannel.stop(),this.backgroundMusic.addEventListener(egret.Event.COMPLETE,this.play,this),this.backgroundMusic.load(t)},e.prototype.play=function(){this.backgroundMusicChannel=this.backgroundMusic.play(0,0)},e.prototype.movePlayer=function(t){if(console.log("moving"),null!=this.selectedPlayer&&"undefined"!=typeof this.selectedPlayer){this.stage.contains(this._life)&&this.stage.removeChild(this._life);var e=this.selectedPlayer.getBitmap();egret.Tween.removeTweens(e);var i={x:e.x,y:e.y},n={x:t.stageX,y:t.stageY},r=this.selectedPlayer.getTask().action;this.drawRoute(i,n,r);var o={x:t.stageX-17,y:t.stageY-25};egret.Tween.get(e).to(o,3e3,egret.Ease.sineIn).wait(500).call(this.doAction.bind(this,this.selectedPlayer,r,o,n))}},e.prototype.mountMovement=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.movePlayer,this)},e.prototype.unmountMovement=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.movePlayer,this)},e.prototype.doAction=function(t,e,i,n){var r=this;this.clearRoute(e);var o=t.getTask().target,a=null==o||null==o.getBitmap()?!1:o.getBitmap().hitTestPoint(n.x,n.y,!0);if(console.log("execute="+a),a){var s=this.createBitmapByName("sword_png");s.x=i.x,s.y=i.y,this.stage.addChild(s),"attack"==e?this.attackTarget(i).then(function(){t.setTask({action:"attack",target:null,status:"completed"}),r.recall(t)}):t.setTask({action:"enforce",target:o,status:"completed"}),setTimeout(function(){r.stage.removeChild(s),s=null},1e3)}else t.setTask({action:"idle",target:null})},e.prototype.attackTarget=function(t){var e=this,i=new egret.MovieClipDataFactory(RES.getRes("fight_json"),RES.getRes("fight_png")),n=new egret.MovieClip(i.generateMovieClipData("fight"));n.x=t.x,n.y=t.y,n.width=50,n.height=50,this.board.addChild(n),n.play(20),this.actionSound(RES.getRes("shooting_mp3").url);var r=new egret.MovieClipDataFactory(RES.getRes("money_json"),RES.getRes("money_png")),o=new egret.MovieClip(r.generateMovieClipData("money"));return o.x=t.x,o.y=t.y-30,this.board.addChild(o),o.play(2),this.actionSound(RES.getRes("destroyhuman_wav").url),setTimeout(function(){e.board.removeChild(o)},2e3),new Promise(function(t,i){setTimeout(function(){e.board.removeChild(n),e.board.contains(e._life)&&e.board.removeChild(e._life),t()},1e3)})},e.prototype.drawRoute=function(t,e,i){this.clearRoute(i);var n,r,o;switch(i){case"attack":n=16711680,r=25,o=25;break;case"enforce":n=60928,r=10,o=50;break;default:n=16776960,r=10,o=50}this._route.graphics.lineStyle(2,n),this._route.graphics.moveTo(t.x,t.y),this._route.graphics.lineTo(e.x,e.y),this[i].x=e.x-r,this[i].y=e.y-o,this.stage.addChild(this[i])},e.prototype.clearRoute=function(t){this._route.graphics.clear(),this.stage.contains(this[t])&&this.stage.removeChild(this[t]),this.stage.contains(this._life)&&this.stage.removeChild(this._life)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.mouseDown=function(t){this._touchStatus=!0,this._distance.x=t.stageX-t.target.x,this._distance.y=t.stageY-t.target.y,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.mouseMove=function(t){if(this._touchStatus)try{t.target.x=t.stageX-this._distance.x,t.target.y=t.stageY-this._distance.y}catch(e){console.log(e)}},e.prototype.mouseUp=function(t){this._touchStatus=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.removePlayerIcon=function(t){var e=this,i=t.getUUID();this.soilderIconList.map(function(t,n){t.key==i&&(e.stage.contains(t.icon)&&e.stage.removeChild(t.icon),e.soilderIconList.splice(n,1))})},e.prototype.refrashPlayerIcon=function(){this.soilderIconList.map(function(t,e){t.icon.x=110+68*e})},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,n=t.map(function(t){return i.parse(t)}),r=this.textfield,o=-1,a=function(){o++,o>=n.length&&(o=0);var t=n[o];r.textFlow=t;var i=egret.Tween.get(r);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(a,e)};a()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]
})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Cell=function(t){function e(e,i,n){var r=t.call(this)||this;return r.task={action:"idle",target:null,status:null},r.position=new egret.Point(0,0),r.item=null,r.battleTime=0,r.createCell(e,i,n),r}return __extends(e,t),e.prototype.createCell=function(t,e,i){this.id=i,this.cellBitmap=this.createBitmapByName("bg1_jpg"),this.cellBitmap.width=80,this.cellBitmap.height=80,this.position=new egret.Point(this.cellBitmap.width*t,this.cellBitmap.height*e),this.x=this.position.x,this.y=this.position.y,this.cellBitmap.touchEnabled=!0,this.cell_X_Y={x:t,y:e},this.addChild(this.cellBitmap),this.touchEnabled=!0},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.getBitmap=function(){return this.cellBitmap},e.prototype.setTask=function(t){this.task=t},e.prototype.getTask=function(){return this.task},e.prototype.getPosition=function(){var t={x:this.x,y:this.y};return t},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.destroy=function(){this.cellBitmap=null},e.prototype.getID=function(){return this.id},e.prototype.getXY=function(){return this.cell_X_Y},e.prototype.getItem=function(){return this.item},e.prototype.setItem=function(t){this.item=t},e.prototype.addItem=function(t){this.contains(this.item)&&(this.item.destroy(),this.removeChild(this.item)),this.item=t,this.addChild(this.item)},e.prototype.setBattleTime=function(t){this.battleTime=t},e.prototype.getBattleTime=function(){return this.battleTime},e}(egret.DisplayObjectContainer);__reflect(Cell.prototype,"Cell");var ScatterUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getEOS=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return null==this.eos?[2,Eos(this.config)]:[2,this.eos]})})},e.connect=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,ScatterJS.scatter.connect("scatter")];case 1:return t.connected=e.sent(),[2,this.connected]}})})},e.login=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i=this;return __generator(this,function(n){switch(n.label){case 0:return[4,this.connect()];case 1:if(n.sent(),!this.connected)return console.log("not connected"),[2,{login:!1,details:this.message.nowallet}];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,ScatterJS.scatter.getIdentity({accounts:[this.network.EOS]}).then(function(t){return console.log("identities",t,ScatterJS.scatter.identity),i.currentAccount=t.accounts[0],i.eos=ScatterJS.scatter.eos(i.network.EOS,Eos),{login:!0,details:i.currentAccount.name}})];case 3:return t=n.sent(),[2,t];case 4:return e=n.sent(),[2,{login:!1,details:"未能使用钱包，可能是"+this.message.walletlock+"或者"+this.message.noidentity}];case 5:return[2]}})})},e.getAccountInfo=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return null!=this.eos?[3,2]:(t=this,[4,this.getEOS()]);case 1:t.eos=i.sent(),i.label=2;case 2:return[4,this.eos.getAccount(this.currentAccount.name).then(function(t){return console.log(t),t})["catch"](function(t){return t})];case 3:return e=i.sent(),[2,e]}})})},e.getAllGamesInfo=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return null!=this.eos?[3,2]:(t=this,[4,this.getEOS()]);case 1:t.eos=i.sent(),i.label=2;case 2:return[4,this.eos.getTableRows({json:!0,scope:"eat.chicken",code:"eat.chicken",table:"games"}).then(function(t){return console.log(t),t})["catch"](function(t){return t})];case 3:return e=i.sent(),[2,e]}})})},e.getGameInfo=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(n){switch(n.label){case 0:return null!=this.eos?[3,2]:(e=this,[4,this.getEOS()]);case 1:e.eos=n.sent(),n.label=2;case 2:return[4,this.eos.getTableRows({json:!0,scope:"eat.chicken",code:"eat.chicken",table:"games",limit:1,lower_bound:t,upper_bound:t+1}).then(function(t){return t})["catch"](function(t){return t})];case 3:return i=n.sent(),[2,i]}})})},e.createGame=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.eos.transaction({actions:[{account:"eosio.token",name:"transfer",authorization:[{actor:this.currentAccount.name,permission:"active"}],data:{from:this.currentAccount.name,to:"eat.chicken",quantity:t,memo:""}}]}).then(function(t){return t})["catch"](function(t){return t})];case 1:return e=i.sent(),[2,e]}})})},e.joinGame=function(t,e,i,n){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(o){switch(o.label){case 0:return[4,this.eos.transaction({actions:[{account:"eosio.token",name:"transfer",authorization:[{actor:this.currentAccount.name,permission:"active"}],data:{from:this.currentAccount.name,to:"eat.chicken",quantity:e,memo:t+","+i+","+n}}]}).then(function(t){return console.log("res",t),t})["catch"](function(t){return t})];case 1:return r=o.sent(),[2,r]}})})},e.setMap=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,fetch("http://114.115.135.201:52919/api?a=setmap&game_id="+t,{method:"GET"}).then(function(t){return t.json()}).then(function(t){return console.log(t),t})];case 1:return e=i.sent(),[2,e]}})})},e.kickOff=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.eos.transaction({actions:[{account:"eat.chicken",name:"kickoff",authorization:[{actor:this.currentAccount.name,permission:"active"}],data:{who:this.currentAccount.name,game_id:t}}]}).then(function(t){return t})["catch"](function(t){return t})];case 1:return e=i.sent(),[2,e]}})})},e.move=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:return[4,this.eos.transaction({actions:[{account:"eat.chicken",name:"move",authorization:[{actor:this.currentAccount.name,permission:"active"}],data:{who:this.currentAccount.name,game_id:t,row:e,column:i}}]}).then(function(t){return t})["catch"](function(t){return t})];case 1:return n=r.sent(),[2,n]}})})},e.logout=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){try{return t=this.currentAccount.name,ScatterJS.scatter.forgetIdentity(),this.currentAccount=null,this.eos=null,[2,{logout:!0,details:t+this.message.logout}]}catch(i){return console.log(i),[2,{logout:!1,details:"登出失败"}]}return[2]})})},e.getCurrentAccountName=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return null!=this.currentAccount?[2,this.currentAccount.name]:[2,null]})})},e.getIdentity=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,ScatterJS.scatter.identity]})})},e.nowseconds=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,fetch("http://114.115.135.201:52920/api/?a=now",{method:"GET"}).then(function(t){return t.json()}).then(function(t){return t})];case 1:return t=e.sent(),[2,t]}})})},e.eos=null,e.connected=!1,e.currentAccount=null,e.message={authority:"未授权用户，请先登录",walletlock:"钱包已上锁",noidentity:"未验证钱包身份",nowallet:"亲，还没有装钱包哟",login:"已登陆游戏",logout:"已登出游戏"},e.chain={main:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",jungle:"038f4b0fc8ff18a4f0842a8f0564611f6e96e8535901dd45e43ac8691a1c4dca",dev:"cf057bbfb72640471fd910bcb67639c22df9f92470936cddc1ade0e2f2e7dc4f"},e.Blockchains={EOSIO:"eos",Ethereum:"eth",Tron:"trx"},e.network={EOS:{blockchain:"eos",protocol:"http",host:"114.115.135.201",port:8888,chainId:e.chain.dev},ETH:{blockchain:"eth",protocol:"http",host:"114.115.135.201",port:8888,chainId:e.chain.dev},TRX:{blockchain:"trx",protocol:"http",host:"114.115.135.201",port:8888,chainId:e.chain.dev}},e.config={keyProvider:["5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3","5KRF8dr2fvHx9dVQyBqWwYhs7KvT8UdCb8Fy6hpWqHp6yZ1K6T3"],httpEndpoint:"http://114.115.135.201:8888",chainId:e.chain.dev,expireInSeconds:60,broadcast:!0,debug:!1,sign:!0},e}(Object);__reflect(ScatterUtils.prototype,"ScatterUtils");var Clock=function(t){function e(){var e=t.call(this)||this;return e.stageW=65,e.stageH=65,e.createMin=(new Date).getMinutes(),e.createHour=(new Date).getHours(),e.gameTime=new Date(2018,1,1,0,0,0),e.interval=-1,e.createClock(),e}return __extends(e,t),e.prototype.createClock=function(){this.pan=new Pan(this.stageW),this.pan.x=this.stageW/2,this.pan.y=this.stageH/2,this.addChild(this.pan),this.HourPointer=new HourPointer,this.HourPointer.x=this.stageW/2,this.HourPointer.y=this.stageH/2,this.addChild(this.HourPointer),this.HourPointer.initHour(this.stageW/2-20,this.gameTime),this.MinPointer=new MinPointer,this.MinPointer.x=this.stageW/2,this.MinPointer.y=this.stageH/2,this.addChild(this.MinPointer),this.MinPointer.initMin(this.stageW/2-10,this.gameTime),this.SecPointer=new SecPointer,this.SecPointer.x=this.stageW/2,this.SecPointer.y=this.stageH/2,this.addChild(this.SecPointer),this.SecPointer.initSec(this.stageW/2,this.gameTime)},e.prototype.drawPointer=function(){this.gameTime=new Date(this.gameTime.getTime()+1e3),this.SecPointer.initSec(this.stageW-10,this.gameTime);var t=this.gameTime.getMinutes(),e=this.gameTime.getHours();t!=this.createMin&&(this.MinPointer.initMin(this.stageW-20,this.gameTime),this.createMin=t),e!=this.createHour&&(this.HourPointer.initHour(this.stageW-30,this.gameTime),this.createHour=e)},e.prototype.start=function(){egret.clearInterval(this.interval),this.interval=egret.setInterval(this.drawPointer,this,1e3)},e}(egret.DisplayObjectContainer);__reflect(Clock.prototype,"Clock");var HourPointer=function(t){function e(){var e=t.call(this)||this;return e.myHour=new egret.Shape,e.addChild(e.myHour),e}return __extends(e,t),e.prototype.initHour=function(t,e){var i=e.getHours();i=i>12?i-12:i,this.myHour.graphics.clear(),this.myHour.graphics.lineStyle(8,15597568),this.myHour.graphics.moveTo(0,0),this.myHour.graphics.lineTo(0,-t),this.myHour.anchorOffsetY=0,this.myHour.anchorOffsetX=0,this.myHour.rotation=30*i,this.myHour.graphics.endFill()},e}(egret.Sprite);__reflect(HourPointer.prototype,"HourPointer");var MinPointer=function(t){function e(){var e=t.call(this)||this;return e.myMin=new egret.Shape,e.addChild(e.myMin),e}return __extends(e,t),e.prototype.initMin=function(t,e){this.myMin.graphics.clear(),this.myMin.graphics.lineStyle(6,255),this.myMin.graphics.moveTo(0,0),this.myMin.graphics.lineTo(0,-t),this.myMin.anchorOffsetY=0,this.myMin.anchorOffsetX=0,this.myMin.rotation=6*e.getMinutes(),this.myMin.graphics.endFill()},e}(egret.Sprite);__reflect(MinPointer.prototype,"MinPointer");var Pan=function(t){function e(e){var i=t.call(this)||this;return i.Init(e),i}return __extends(e,t),e.prototype.Init=function(t){this.initCircle(t),this.initScale(t)},e.prototype.initCircle=function(t){this.mypan=new egret.Shape,this.mypan.graphics.beginFill(16777215),this.mypan.graphics.drawCircle(0,0,t),this.mypan.graphics.endFill(),this.addChild(this.mypan)},e.prototype.initScale=function(t){for(var e=0;60>e;e++)this.myscale1=new egret.Shape,this.myscale1.graphics.lineStyle(2,0),this.myscale1.graphics.moveTo(0,0),this.myscale1.graphics.lineTo(0,5),this.myscale1.graphics.endFill(),this.myscale1.anchorOffsetY=t,this.myscale1.rotation=6*e,this.addChild(this.myscale1);for(var i=0;12>i;i++)this.myscale2=new egret.Shape,this.myscale2.graphics.lineStyle(4,0),this.myscale2.graphics.moveTo(0,0),this.myscale2.graphics.lineTo(0,10),this.myscale2.graphics.endFill(),this.myscale2.anchorOffsetY=t,this.myscale2.rotation=30*i,this.addChild(this.myscale2)},e}(egret.Sprite);__reflect(Pan.prototype,"Pan");var SecPointer=function(t){function e(){var e=t.call(this)||this;return e.mySec=new egret.Shape,e.addChild(e.mySec),e}return __extends(e,t),e.prototype.initSec=function(t,e){this.mySec.graphics.clear(),this.mySec.graphics.lineStyle(4,16711680),this.mySec.graphics.moveTo(0,0),this.mySec.graphics.lineTo(0,-t),this.mySec.anchorOffsetY=0,this.mySec.anchorOffsetX=0,this.mySec.rotation=6*e.getSeconds(),this.mySec.graphics.endFill()},e}(egret.Sprite);__reflect(SecPointer.prototype,"SecPointer");